(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{119:function(e,t,c){},131:function(e,t,c){},137:function(e,t){},167:function(e,t,c){},169:function(e,t,c){},175:function(e,t,c){},210:function(e,t){},211:function(e,t){},212:function(e,t){},213:function(e,t){},214:function(e,t){},232:function(e,t,c){"use strict";c.r(t);var n=c(0),r=c.n(n),a=c(29),s=c.n(a),o=(c(167),c(168),c(35)),i=(c(169),c(235)),j=c(128),u=c(238),b=c(52),l=c(242),d=(c(119),c(243)),O=c(244),h=c(43),f=c(44),p=c(25),x=c.n(p),m=c(41),v=c(36),y=c(38),g=c(123),S=c(146),N="LOAD_LIBRARY",A="ADD_JOB",E="REFRESH_JOB",w="LOAD_DOCUMENT",I="SET_BREADCRUMB";function D(e,t){switch(t.type){case N:return Object(y.a)(Object(y.a)({},e),{},{library:t.payload});case A:return Object(y.a)(Object(y.a)({},e),{},{jobs:[].concat(Object(v.a)(e.jobs),[t.payload])});case E:var c=e.jobs.map((function(e){return e.id!==t.payload.id?e:t.payload}));return Object(y.a)(Object(y.a)({},e),{},{jobs:c});case w:return Object(y.a)(Object(y.a)({},e),{},{document:t.payload});case I:return Object(y.a)(Object(y.a)({},e),{},{breadcrumbs:t.payload});default:return e}}var T=function(e){return function(e){return function(t){return e(t)}}};var C=function(){var e=Object(m.a)(x.a.mark((function e(t,c){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:8000/api/documents/").then((function(e){return e.json()}));case 2:n=e.sent,t({type:N,payload:{documentsAvailable:0,documents:n.results,ready:!0,loading:!1}});case 4:case"end":return e.stop()}}),e)})));return function(t,c){return e.apply(this,arguments)}}(),R=c(53),k=c(7),P=j.a.SubMenu,L=i.a.Sider;var _=function(){var e=Object(h.b)(),t=Object(h.c)((function(e){return e?{library:e.library}:{}})).library;return Object(n.useEffect)((function(){e(C)}),[]),Object(k.jsx)(L,{width:200,className:"site-layout-background",children:Object(k.jsxs)(j.a,{mode:"inline",defaultOpenKeys:["sub1"],style:{height:"100%",borderRight:0},children:[Object(k.jsx)(j.a.Item,{icon:Object(k.jsx)(d.a,{}),children:Object(k.jsx)(R.b,{to:"/",children:"Upload"})},"link"),Object(k.jsx)(P,{icon:Object(k.jsx)(O.a,{}),title:"Recent",children:t?t.documents.map((function(e){return Object(k.jsx)(j.a.Item,{children:Object(k.jsx)(R.b,{to:"/documents/".concat(e.id),children:e.filename})},e.id)})):null},"sub1")]})})},J=c(241),U=c(91),z=c(116);function B(e){var t=e.children;return Object(k.jsx)("div",{className:"pt-3 pb-3 text-center bg-gray-200 rounded-xl shadow-md",children:t})}function K(e){var t=e.visible,c=e.onClose,n=Object(z.b)(),r=n.register,a=n.handleSubmit,s=n.control;return Object(k.jsxs)(J.a,{visible:t,onCancel:c,title:"Setup Wizard",footer:[],children:[Object(k.jsx)(B,{children:"Can also edit these on the Settings page"}),Object(k.jsx)("br",{}),Object(k.jsxs)("form",{onSubmit:a((function(e){fetch("http://0.0.0.0:8000/api/config/",{method:"POST",body:JSON.stringify(e)}).then((function(e){return e.json()}))})),children:[Object(k.jsx)("h3",{children:"Storage Options"}),Object(k.jsx)(z.a,{name:"storageOption",defaultValue:"nas",control:s,render:function(e){var t=e.onChange,c=e.value;return Object(k.jsxs)(U.a,{onChange:t,value:c,className:"w-full",children:[Object(k.jsx)(U.a.Option,{value:"nas",children:"NAS"}),Object(k.jsx)(U.a.Option,{value:"local",children:"Local (on the server)"})]})}}),Object(k.jsx)("br",{}),Object(k.jsx)("br",{}),Object(k.jsx)("h3",{children:"Cloud Vision API Key"}),Object(k.jsx)(u.a,Object(y.a)({className:"w-full",type:"text"},r("gcvKey"))),Object(k.jsx)("br",{}),Object(k.jsx)("br",{}),Object(k.jsx)("h3",{children:"Django Secret Key"}),Object(k.jsx)(z.a,{name:"djangoSecretKey",defaultValue:"create",control:s,render:function(e){var t=e.onChange,c=e.value;return Object(k.jsxs)(U.a,{onChange:t,value:c,className:"w-full",children:[Object(k.jsx)(U.a.Option,{value:"create",children:"Create one for me"}),Object(k.jsx)(U.a.Option,{value:"custom",children:"Custom"})]})}}),Object(k.jsx)("br",{}),Object(k.jsx)(b.a,{onClick:c,children:"Return"}),Object(k.jsx)("button",{type:"submit",children:"Submit"})]})]})}var M=c(113),G=c(27),H=i.a.Header,q=i.a.Content;var F=function(e){var t=Object(n.useState)(!1),c=Object(o.a)(t,2),r=c[0],a=c[1],s=Object(n.useState)(),d=Object(o.a)(s,2),O=d[0],f=d[1],p=Object(G.f)(),x=function(){O&&p.push("/search?q=".concat(encodeURIComponent(O)))},m=Object(h.c)((function(e){return e?{breadcrumbs:e.breadcrumbs}:{}})).breadcrumbs;return Object(n.useEffect)((function(){}),[]),Object(k.jsxs)(i.a,{children:[Object(k.jsx)(K,{visible:r,onClose:function(){return a(!1)}}),Object(k.jsxs)(H,{className:"header AppHeader",children:[Object(k.jsx)("div",{className:"AppLogo",children:"librarian"}),Object(k.jsxs)(j.a,{theme:"dark",mode:"horizontal",defaultSelectedKeys:["2"],children:[Object(k.jsx)(j.a.Item,{children:Object(k.jsx)(R.b,{to:"/",children:"Home"})},"1"),Object(k.jsx)(j.a.Item,{children:"Docs"},"2"),Object(k.jsx)(j.a.Item,{children:"Search"},"3"),Object(k.jsx)(j.a.Item,{onClick:function(){return a(!0)},children:"Settings"},"4"),Object(k.jsxs)("div",{className:"items-center h-16 flex float-right pr-4 w-auto",children:[Object(k.jsx)(u.a,{onChange:function(e){return f(e.target.value)},onPressEnter:x,type:"text",placeholder:"Search"}),Object(k.jsx)(b.a,{onClick:x,className:"items-center",children:Object(k.jsx)(M.a,{})})]},"5")]})]}),Object(k.jsxs)(i.a,{children:[Object(k.jsx)(_,{}),Object(k.jsxs)(i.a,{style:{padding:"0 24px 24px"},children:[Object(k.jsx)(l.a,{style:{margin:"16px 0"},children:m?m.map((function(e,t){return Object(k.jsx)(l.a.Item,{children:e},t)})):null}),Object(k.jsx)(q,{className:"AppContent",children:e.children})]})]})]})},V=(c(131),c(157)),W=c(237);c(175);var Y=c(239);var Q=function(e){return Object(k.jsx)("div",{children:Object(k.jsx)(Y.a,{percent:e.percent,status:e.done?e.success?"success":"exception":"active"})})};var X=function(e){var t=Object(h.b)();return function(e,t){var c=Object(n.useRef)();Object(n.useEffect)((function(){c.current=e}),[e]),Object(n.useEffect)((function(){if(null!==t){var e=setInterval((function(){c.current()}),t);return function(){return clearInterval(e)}}}),[t])}((function(){var c;t((c=e.job.id,function(){var e=Object(m.a)(x.a.mark((function e(t,n){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://0.0.0.0:8000/api/documents/".concat(c,"/details")).then((function(e){return e.json()})).then((function(e){t({type:E,payload:e})}));case 2:case"end":return e.stop()}}),e)})));return function(t,c){return e.apply(this,arguments)}}()))}),"ANNOTATED"===e.job.status?null:1e3),Object(k.jsxs)("div",{className:"Job",children:[Object(k.jsx)("div",{className:"JobFilename",children:"ANNOTATED"===e.job.status?Object(k.jsx)(R.b,{to:"/documents/".concat(e.job.id),children:e.job.filename}):e.job.filename}),Object(k.jsx)("div",{className:"JobProgress",children:function(){switch(e.job.status){case"CREATED":return Object(k.jsx)(Q,{percent:10,done:!1,success:!1});case"PERSISTING":return Object(k.jsx)(Q,{percent:25,done:!1,success:!1});case"PERSISTED":return Object(k.jsx)(Q,{percent:40,done:!1,success:!1});case"TRANSLATING_PDF_TO_IMAGES":return Object(k.jsx)(Q,{percent:55,done:!1,success:!1});case"TRANSLATED_PDF_TO_IMAGES":return Object(k.jsx)(Q,{percent:70,done:!1,success:!1});case"ANNOTATING":return Object(k.jsx)(Q,{percent:85,done:!1,success:!1});case"ANNOTATED":return Object(k.jsx)(Q,{percent:100,done:!0,success:!0});default:return Object(k.jsx)(Q,{percent:100,done:!0,success:!1})}}()})]})},Z=function(){var e=Object(h.b)();Object(n.useEffect)((function(){e({type:I,payload:["Docs","Upload"]})}),[]);var t=Object(h.c)((function(e){return e?{jobs:e.jobs}:{}})).jobs,c=Object(n.useCallback)((function(t){e(function(e){return function(){var t=Object(m.a)(x.a.mark((function t(c,n){var r,a,s;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=Object(f.a)(e),t.prev=1,r.s();case 3:if((a=r.n()).done){t.next=9;break}return s=a.value,t.next=7,fetch("http://0.0.0.0:8000/api/documents/".concat(s.name),{method:"POST",body:s}).then((function(e){return e.json()})).then((function(e){console.log("here!"),c({type:A,payload:e})}));case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),r.e(t.t0);case 14:return t.prev=14,r.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[1,11,14,17]])})));return function(e,c){return t.apply(this,arguments)}}()}(t))}),[]),r=Object(V.a)({onDrop:c}),a=r.getRootProps,s=r.getInputProps,o=r.isDragActive;return Object(k.jsxs)("div",{children:[Object(k.jsxs)("div",Object(y.a)(Object(y.a)({},a()),{},{className:"Uploader",children:[Object(k.jsx)("input",Object(y.a)({},s())),Object(k.jsx)("p",{}),Object(k.jsx)("p",{}),Object(k.jsx)(d.a,{style:{fontSize:50}}),Object(k.jsx)("p",{}),o?Object(k.jsx)("p",{className:"UploaderText",children:"Drop the files here ..."}):Object(k.jsx)("p",{className:"UploaderText",children:"Drag 'n' drop some files here, or click to select files"})]})),Object(k.jsx)("div",{children:Object(k.jsx)(W.b,{itemLayout:"horizontal",dataSource:t,renderItem:function(e){return Object(k.jsx)(W.b.Item,{children:Object(k.jsx)(X,{job:e})})}})})]})},$=c(152),ee=c(127);var te=function(){var e=Object(h.b)(),t=Object(G.h)().documentId;Object(n.useEffect)((function(){e({type:I,payload:["Docs","Recent"]})}),[]);var c=Object(n.useState)(null),r=Object(o.a)(c,2),a=r[0],s=r[1],i=Object(n.useState)(null),j=Object(o.a)(i,2),u=(j[0],j[1]),b=Object(n.useRef)(),l=function(e){var t=Object(n.useState)({width:0,height:0}),c=Object(o.a)(t,2),r=c[0],a=c[1];return Object(n.useEffect)((function(){var t=function(){return{width:e&&e.current.offsetWidth||0,height:e&&e.current.offsetHeight||0}},c=function(){a(t())};return e.current&&a(t()),window.addEventListener("resize",c),function(){window.removeEventListener("resize",c)}}),[e]),r}(b).width;return Object(k.jsx)("div",{ref:b,children:Object(k.jsx)(ee.a,{file:"http://0.0.0.0:8000/api/documents/".concat(t,"/data"),loading:Object(k.jsx)($.a,{size:"large"}),onLoadSuccess:function(e){s(e.numPages),u(e)},children:Array.from(new Array(a),(function(e,t){return Object(k.jsx)(ee.b,{width:l,pageNumber:t+1},"page_".concat(t+1))}))})})},ce=c(240),ne=c(236),re=c(126),ae=c.n(re);var se=function(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),c=t[0],r=t[1],a=Object(n.useState)([]),s=Object(o.a)(a,2),i=s[0],j=s[1],u=new URLSearchParams(Object(G.g)().search).get("q");return console.log(u),Object(n.useEffect)((function(){ae.a.get("http://localhost:8000/api/documents/search",{params:{q:u}}).then((function(e){return r(e.data)})),ae.a.get("http://localhost:8000/api/documents/text/search",{params:{q:u}}).then((function(e){return j(e.data)}))}),[u]),Object(k.jsxs)("div",{children:[Object(k.jsx)("h1",{children:"Document Search"}),Object(k.jsx)("p",{children:JSON.stringify(c)}),Object(k.jsx)("h1",{children:"Document Text Search"}),Object(k.jsx)("p",{children:JSON.stringify(i)})]})},oe=function(e){var t=Object(g.a)(S.a,T);return Object(g.b)(D,e,t)}({jobs:[],library:{documentsAvailable:0,documents:[],ready:!1,loading:!1},document:null,breadcrumbs:[]}),ie=new ce.a;s.a.render(Object(k.jsx)(r.a.StrictMode,{children:Object(k.jsx)(h.a,{store:oe,children:Object(k.jsx)(R.a,{children:Object(k.jsx)(ne.a,{client:ie,children:Object(k.jsx)(F,{children:Object(k.jsxs)(G.c,{children:[Object(k.jsx)(G.a,{path:"/documents/:documentId",children:Object(k.jsx)(te,{})}),Object(k.jsx)(G.a,{path:"/search",children:Object(k.jsx)(se,{})}),Object(k.jsx)(G.a,{path:"/",children:Object(k.jsx)(Z,{})})]})})})})})}),document.getElementById("root"))}},[[232,1,2]]]);
//# sourceMappingURL=main.04111e3a.chunk.js.map